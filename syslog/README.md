## Table of content

- [How to master syslog](./how-to-master-syslog.md)

## To do list

- [ ] [Syslog Explained | Cisco CCNA 200-301](https://www.youtube.com/watch?v=BMVHHX02T4Q)
- [ ] [Free CCNA | Syslog | Day 41 | CCNA 200-301 Complete Course](https://www.youtube.com/watch?v=RaQPSKQ4J5A&list=PLxbwE86jKRgMpuZuLBivzlM8s2Dk5lXBQ&index=83)
- [ ] [Rsyslog - Log Processing in Linux](https://www.youtube.com/watch?v=fgdXuqiyUKs)
- [ ] Storing Logs in a Centralized server

# Syslog Monitoring Documentation

## 1. **Syslog Basics**

### What is Syslog?

**Syslog** (short for _System Logging Protocol_) is a standard protocol used for logging system and application events. It is widely used for collecting, storing, and managing log data generated by network devices, servers, and various software applications. Syslog allows for centralized logging, which makes it easier to monitor, analyze, and troubleshoot systems and applications.

Syslog works by enabling devices (e.g., routers, switches, firewalls, servers, applications) to generate logs that are sent to a **syslog server** for storage and analysis. These logs typically contain information about system activities, errors, warnings, user actions, or system health, making it an invaluable tool for network monitoring, security, and troubleshooting.

---

### How Does Syslog Work?

The syslog protocol is based on a client-server model, where the device that generates the log (called the **syslog client**) sends messages to a syslog server. The logs are transferred over UDP (by default) or TCP, depending on configuration and reliability requirements.

The flow of syslog data typically works as follows:

1. **Log Generation**: A system, device, or application generates a log message. This could be triggered by events like a failed login, system crash, or an application error.
2. **Syslog Client**: The syslog client (which could be an application, device, or service) formats the log message and sends it to the syslog server.

3. **Transmission Protocol**: By default, syslog messages are sent over UDP port 514, though they can also be transmitted over TCP for added reliability. For secure communication, TLS can be used to encrypt syslog messages.

4. **Syslog Server**: The syslog server receives, processes, and stores log messages. It can either store logs locally or forward them to other systems for further analysis, such as SIEM (Security Information and Event Management) systems.

5. **Log Storage and Analysis**: Syslog servers typically store logs in flat text files or databases. These logs can be analyzed manually or automatically using monitoring tools and alert systems.

---

### Syslog Server

A **syslog server** is a system responsible for receiving and managing syslog messages from various syslog clients. It collects logs, aggregates them, and stores them in a centralized location. The syslog server is crucial for troubleshooting, monitoring, and auditing activities across an enterprise environment.

Key responsibilities of a syslog server:

- **Log Aggregation**: Collects logs from different devices and systems.
- **Log Storage**: Stores log data locally or forwards it to a secondary storage solution, such as a database or log management platform.
- **Log Management**: Helps organize and manage log data for easy retrieval and analysis.
- **Alerting**: May generate alerts based on predefined log patterns (e.g., error messages, security events).

**Syslog Server Example**: `rsyslog` is a popular syslog server that can handle syslog messages from various devices and systems, manage log files, and support advanced configurations (e.g., filtering, forwarding logs to remote systems).

---

### Syslog Message Structure

A syslog message follows a defined structure, which allows for uniformity in message processing. The basic components of a syslog message are:

1. **PRI (Priority)**: This is a single numeric value that combines two elements: the **facility** and the **severity** level. The PRI value is calculated as:

   \[
   PRI = (Facility \times 8) + Severity
   \]

   - **Facility**: Specifies the source or category of the log (e.g., kernel, user-level processes, mail system, etc.).
   - **Severity**: Indicates the seriousness of the event (e.g., emergency, alert, critical, etc.).

   **Example**: A priority value of 33 corresponds to **Facility: Local7** and **Severity: Notice**.

2. **HEADER**: Contains the **timestamp** (when the log was generated) and the **hostname** (the device from which the log originated).

   Example of HEADER:

   ```
   Jan 27 14:22:13 myhostname
   ```

3. **MSG (Message)**: The actual log message that describes the event or error. This part can contain details such as error codes, descriptions, user information, and more.

   Example of a syslog message:

   ```
   Jan 27 14:22:13 myhostname myapp[12345]: ERROR: Could not connect to database
   ```

   In the example above:

   - **PRI**: Combined from Facility and Severity
   - **HEADER**: Timestamp (`Jan 27 14:22:13`) and Hostname (`myhostname`)
   - **MSG**: Detailed log message (`ERROR: Could not connect to database`)

---

### Syslog Severity Levels

Syslog uses severity levels to indicate the importance of the log message. The severity levels range from 0 (most critical) to 7 (least critical). Here are the common severity levels:

1. **0 – Emergency**: System is unusable.
2. **1 – Alert**: Action must be taken immediately.
3. **2 – Critical**: Critical conditions.
4. **3 – Error**: Error conditions.
5. **4 – Warning**: Warning conditions.
6. **5 – Notice**: Normal but significant conditions.
7. **6 – Informational**: Informational messages.
8. **7 – Debug**: Debug-level messages.

---

### Syslog Facility Types

Syslog messages are categorized by **facility**, which refers to the origin or source of the message. Some common facility types include:

- **0 – Kernel**: Messages from the operating system kernel.
- **1 – User-level**: User-level programs and processes.
- **2 – Mail system**: Mail system-related messages.
- **3 – System daemons**: Daemons running in the system.
- **4 – Security/authorization**: Messages related to authentication and authorization.
- **5 – Syslog daemons**: Syslog-related messages.
- **6 – Line printer**: Printer messages.
- **7 – Network news**: Usenet news system messages.
- **8-15 – Local use**: Reserved for local use (Local0 to Local7).

---

## 2. **Syslog Servers & Clients**

### Syslog Daemons (e.g., rsyslog)

A **syslog daemon** is a program running on the syslog server that listens for incoming syslog messages and processes them. Popular syslog daemons include:

1. **rsyslog**: This is a highly configurable syslog daemon that allows for filtering, forwarding, and storing logs. It is widely used in Linux and Unix-based systems.

   - **Configuration**: The `rsyslog.conf` file is used for configuring log storage, log forwarding, and filtering.
   - **Features**: Supports TCP/UDP transport, encryption (TLS), log rotation, and more.

2. **syslog-ng**: Another syslog daemon that offers advanced features such as high-performance logging, support for structured data, and remote log collection.

3. **Syslogd**: The traditional syslog daemon used in older Unix systems, though it has largely been replaced by rsyslog and syslog-ng in modern environments.

### Syslog Clients (Devices Sending Logs)

A **syslog client** refers to any system or device that generates logs and sends them to a syslog server. Syslog clients can be:

- **Network devices**: Routers, switches, firewalls, and other network appliances often send logs to a syslog server.
- **Operating systems**: Servers, workstations, and virtual machines running Linux, Windows, or macOS can act as syslog clients.
- **Applications**: Software such as web servers, database management systems, and antivirus programs can be configured to send logs to a syslog server.
- **Security systems**: Intrusion detection systems, firewalls, and security appliances also send logs via syslog.

### Configuring Syslog Clients

Syslog clients need to be configured to send logs to a syslog server. The configuration process depends on the operating system and software in use.

#### Example: Linux (Rsyslog Client Configuration)

1. Edit the `/etc/rsyslog.conf` file to define the syslog server IP address or hostname:
   ```
   *.*   @192.168.1.100   # Send all logs to the syslog server at 192.168.1.100
   ```
2. Restart the rsyslog service to apply changes:
   ```
   sudo systemctl restart rsyslog
   ```

#### Example: Cisco Router (Syslog Client Configuration)

On a Cisco router, the following configuration can be used to send logs to a syslog server:

```
logging 192.168.1.100
logging trap informational
```

---

## Conclusion

Syslog is a fundamental tool for collecting and managing logs across network devices, servers, and applications. Understanding the basic concepts of syslog, such as message structure, severity levels, facilities, and syslog clients/servers, is essential for effective syslog monitoring.

For further exploration, consider configuring a syslog server and client in your environment, testing log collection, and integrating with monitoring tools or SIEM systems to improve log analysis and alerting capabilities.
